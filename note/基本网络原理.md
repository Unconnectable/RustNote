## HTTP 请求中的几个核心概念.

### 1. HTTP 请求方法 (Request Methods)

HTTP 请求方法(或谓词)定义了客户端希望对服务器执行的操作类型.最常见的四种方法是:

- **GET**:用于从服务器**获取**资源.它是最常用的方法.GET 请求不应该有请求体(message body),所有参数都通过 URL 附带.
  - **特点**:幂等(多次请求结果相同),可缓存.
  - **例子**:访问网页 `GET /users/123`,获取 ID 为 123 的用户信息.
- **POST**:用于向服务器**提交**数据,通常是创建新资源.数据通过请求体发送.
  - **特点**:非幂等(多次提交会创建多个资源),不可缓存.
  - **例子**:提交一个表单来创建一个新用户.
- **PUT**:用于向服务器**更新或替换**一个已存在的资源.如果资源不存在,PUT 也可以用于创建.数据通过请求体发送.
  - **特点**:幂等.
  - **例子**:更新 ID 为 123 的用户信息.
- **DELETE**:用于**删除**服务器上的指定资源.
  - **特点**:幂等.
  - **例子**:删除 ID 为 123 的用户.

---

### 2. HTTP 请求头 (Request Headers)

请求头提供了关于请求的额外信息,它们以键值对的形式存在于请求行之后.以下是一些重要的请求头:

- **`Host`**:指定请求的目标服务器的域名和端口号.这是 HTTP/1.1 协议中唯一必须的请求头.
- **`Content-Type`**:指示请求体中数据的媒体类型.例如,`application/json` 表示发送的是 JSON **数据**,`application/x-www-form-urlencoded` 用于表单数据.
- **`Content-Length`**:指示请求体的字节长度.服务器根据这个值来判断请求体何时结束.
- **`User-Agent`**:包含客户端(浏览器、应用等)的信息,例如操作系统和版本.服务器可以据此优化响应内容.
- **`Accept`**:告诉服务器客户端可以接收的媒体类型.例如,`Accept: text/html, application/json` 表示客户端既能接收 HTML,也能接收 JSON.
- **`Authorization`**:用于携带客户端的身份认证信息,例如 API 密钥或 JWT token.

看一个例子,假设我们有一个简单的 HTTP 服务器,它根据请求的路径返回不同的内容.下面是一个简化的 Rust 代码片段,展示了如何处理请求头和生成响应头:

```rust
let response = format!(
    "{}\r\nContent-Length: {}\r\n\r\n{}",
    status_line, len, contents
);
```

---

### 3. 请求参数 (Request Parameters)

请求参数是客户端向服务器传递数据的方式.它们主要有三种形式:

- **URL 参数 (Query Parameters)**:跟在 URL 路径后的参数,用 `?` 引导,用 `&` 分隔.
  - **例子**:在 `GET /search?q=rust&sort=desc` 中,`q` 和 `sort` 就是 URL 参数.
- **路径参数 (Path Parameters)**:作为 URL 路径的一部分,通常用来标识资源.
  - **例子**:在 `GET /users/123` 中,`123` 就是路径参数.
- **请求体参数 (Body Parameters)**:通常用于 **POST** 和 **PUT** 请求,数据以 JSON、XML 或表单等格式放在请求体中发送.
  - **例子**:`POST /users` 请求的请求体可能是一个 JSON 对象:`{"name": "Alice", "email": "alice@example.com"}`.

---

### 4. 状态码 (Status Codes)

状态码是一个三位数的整数,作为 HTTP 响应的第一部分,表示请求的结果.

- **`1xx` (信息)`**:请求已被接收,继续处理.
- **`2xx` (成功)`**:请求已成功被接收、理解和处理.
  - `200 OK`:标准成功响应.
  - `201 Created`:请求已成功,并在服务器上创建了新资源(通常是 POST 或 PUT 请求的响应).
- **`3xx` (重定向)`**:需要进一步的操作来完成请求.
  - `301 Moved Permanently`:资源已永久移动到新位置.
  - `302 Found`:资源临时移动到新位置.
- **`4xx` (客户端错误)`**:请求包含语法错误或无法完成.
  - `400 Bad Request`:服务器无法理解请求,例如请求格式错误.
  - `401 Unauthorized`:请求需要身份验证.
  - `403 Forbidden`:服务器拒绝请求.
  - `404 Not Found`:服务器找不到请求的资源.
- **`5xx` (服务器错误)`**:服务器在处理请求时发生错误.
  - `500 Internal Server Error`:一个通用的服务器端错误.
  - `503 Service Unavailable`:服务器暂时无法处理请求,通常是因为过载或维护.

---

### 常见的 HTTP 请求方法

最常见、最重要的 HTTP 请求方法,它们定义了 Web 客户端(如浏览器)和服务器之间的交互方式.

#### 1. `GET`

**作用:** 从服务器**获取**(retrieve)指定资源.

- **特性:** `GET` 请求是**幂等**(idempotent)的,也就是说,你执行一次和执行多次,结果是一样的,不会对服务器状态产生副作用.
- **例子:** 当你在浏览器地址栏输入一个网址,或者点击一个链接时,浏览器发送的就是一个 `GET` 请求,来获取网页内容.

#### 2. `POST`

- **作用:** 向服务器**提交**(submit)数据,通常用来创建新资源.
- **特性:** `POST` 请求不是幂等的.每次提交都可能在服务器上创建新的资源.
- **例子:** 填写一个表单(比如注册新用户、发布博客文章)并点击提交时,浏览器发送的就是一个 `POST` 请求,将数据发送给服务器.

#### 3. `PUT`

- **作用:** **更新**(update)或**替换**服务器上的某个资源.
- **特性:** `PUT` 请求是幂等的.多次使用 `PUT` 将相同的数据发送到同一 URL,其结果是相同的,即资源只会被创建或更新一次.
- **例子:** 如果你想修改你的个人资料,可以使用 `PUT` 方法将更新后的完整个人信息发送给服务器.

#### 4. `DELETE`

- **作用:** **删除**(delete)服务器上的指定资源.
- **特性:** `DELETE` 请求是幂等的.
- **例子:** 点击“删除”按钮来移除一篇博客文章或一张图片.

#### 5. `HEAD`

- **作用:** 请求服务器返回和 `GET` 请求一样的响应头,但**不返回响应体**.
- **特性:** 用于获取资源的元数据(如大小、类型、修改日期),而无需下载整个内容.这在需要检查文件是否存在或确定文件大小等场景中非常有用.

#### 6. `OPTIONS`

- **作用:** 获取服务器对某个 URL **支持的所有请求方法**.
- **特性:** 通常用于跨域资源共享(CORS)中的“预检(preflight)”请求,以确保客户端可以安全地发送实际请求.
